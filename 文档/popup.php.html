
<!-- saved from url=(0058)http://www.planetb.ca/projects/syntaxHighlighter/popup.php -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<link type="text/css" rel="stylesheet" href="./popup.php_files/SyntaxHighlighter.css">
		<script language="javascript" src="./popup.php_files/shCore.js.下载"></script>
		<script language="javascript" src="./popup.php_files/shBrushCpp.js.下载"></script>
		<script language="javascript" src="./popup.php_files/shBrushXml.js.下载"></script>
	<style type="text/css">.dp-cpp .datatypes { color: #2E8B57; font-weight: bold; }</style></head>
	<body>
		<div class="dp-highlighter"><div class="bar"></div><ol start="1" class="dp-cpp"><li class="alt"><span><span class="preprocessor">#define&nbsp;GLFW_INCLUDE_VULKAN</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="preprocessor">#define&nbsp;GLFW_EXPOSE_NATIVE_WIN32</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="preprocessor">#include&nbsp;&lt;Windows.h&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="preprocessor">#include&nbsp;&lt;GLFW/glfw3.h&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="preprocessor">#include&nbsp;&lt;GLFW/glfw3native.h&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="preprocessor">#include&nbsp;&lt;iostream&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="preprocessor">#include&nbsp;&lt;vulkan/vulkan.h&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="preprocessor">#include&nbsp;&lt;vulkan/vulkan_win32.h&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="preprocessor">#include&nbsp;&lt;vector&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="preprocessor">#include&nbsp;&lt;fstream&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="preprocessor">#include&nbsp;&lt;algorithm&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="preprocessor">#include&nbsp;&lt;set&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="preprocessor">#include&nbsp;&lt;numeric&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>GLFWwindow*&nbsp;window;&nbsp;&nbsp;</span></li><li class=""><span>VkInstance&nbsp;instance;&nbsp;&nbsp;</span></li><li class="alt"><span>std::vector&lt;<span class="keyword">const</span><span>&nbsp;</span><span class="datatypes">char</span><span>*&gt;&nbsp;validationLayerNames&nbsp;=&nbsp;{&nbsp;</span><span class="string">"VK_LAYER_LUNARG_object_tracker"</span><span>&nbsp;};&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">const</span><span>&nbsp;</span><span class="datatypes">float</span><span>&nbsp;width&nbsp;=&nbsp;800;&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">const</span><span>&nbsp;</span><span class="datatypes">float</span><span>&nbsp;height&nbsp;=&nbsp;600;&nbsp;&nbsp;</span></span></li><li class=""><span>VkSemaphore&nbsp;imageAvailableSemaphore;&nbsp;&nbsp;</span></li><li class="alt"><span>VkSemaphore&nbsp;renderFinishedSemaphore;&nbsp;&nbsp;</span></li><li class=""><span>VkQueue&nbsp;graphicsQueue;&nbsp;&nbsp;</span></li><li class="alt"><span>VkQueue&nbsp;presentQueue;&nbsp;&nbsp;</span></li><li class=""><span>VkDevice&nbsp;logicalDevice;&nbsp;&nbsp;</span></li><li class="alt"><span>VkRenderPassCreateInfo&nbsp;renderPassInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class=""><span>VkSwapchainKHR&nbsp;swapChain;&nbsp;&nbsp;</span></li><li class="alt"><span>std::vector&lt;VkCommandBuffer&gt;&nbsp;commandBuffer;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span><span class="keyword">static</span><span>&nbsp;VKAPI_ATTR&nbsp;VkBool32&nbsp;VKAPI_CALL&nbsp;debugCallback(&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkDebugUtilsMessageSeverityFlagBitsEXT&nbsp;messageSeverity,&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkDebugUtilsMessageTypeFlagsEXT&nbsp;messageType,&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">const</span><span>&nbsp;VkDebugUtilsMessengerCallbackDataEXT*&nbsp;pCallbackData,&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">void</span><span>*&nbsp;pUserData)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;std::cout&nbsp;&lt;&lt;&nbsp;<span class="string">"validation&nbsp;layer:&nbsp;"</span><span>&nbsp;&lt;&lt;&nbsp;pCallbackData-&gt;pMessage&nbsp;&lt;&lt;&nbsp;std::endl;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;VK_FALSE;&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span><span class="datatypes">int</span><span>&nbsp;main()&nbsp;&nbsp;</span></span></li><li class=""><span>{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;1.&nbsp;Init&nbsp;Window</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;glfwInit();&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;glfwWindowHint(GLFW_CLIENT_API,&nbsp;GLFW_NO_API);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;glfwWindowHint(GLFW_RESIZABLE,&nbsp;GLFW_FALSE);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;window&nbsp;=&nbsp;glfwCreateWindow(width,&nbsp;height,&nbsp;<span class="string">"Vulkan&nbsp;window"</span><span>,&nbsp;nullptr,&nbsp;nullptr);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2.&nbsp;check&nbsp;validation&nbsp;layer&nbsp;support&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;uint32_t&nbsp;layerCount;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vkEnumerateInstanceLayerProperties(&amp;layerCount,&nbsp;nullptr);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;std::vector&lt;VkLayerProperties&gt;&nbsp;availableLayers(layerCount);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vkEnumerateInstanceLayerProperties(&amp;layerCount,&nbsp;availableLayers.data());&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(auto&nbsp;validationLayerName&nbsp;:&nbsp;validationLayerNames)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="datatypes">bool</span><span>&nbsp;support&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(auto&nbsp;supportedLayerName&nbsp;:&nbsp;availableLayers)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(strcmp(supportedLayerName.layerName,&nbsp;validationLayerName)&nbsp;==&nbsp;0)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;support&nbsp;=&nbsp;<span class="keyword">true</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">break</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(support&nbsp;==&nbsp;</span><span class="keyword">false</span><span>)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::cout&nbsp;&lt;&lt;&nbsp;validationLayerName&nbsp;&lt;&lt;&nbsp;<span class="string">"&nbsp;is&nbsp;not&nbsp;supported&nbsp;.&nbsp;"</span><span>&nbsp;&lt;&lt;&nbsp;std::endl;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"&nbsp;not&nbsp;all&nbsp;validation&nbsp;layer&nbsp;is&nbsp;supported&nbsp;.&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;3.&nbsp;Create&nbsp;Instance</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;3.1&nbsp;fill&nbsp;the&nbsp;application&nbsp;info</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkApplicationInfo&nbsp;appInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;appInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_APPLICATION_INFO;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;appInfo.pApplicationName&nbsp;=&nbsp;<span class="string">"Hello&nbsp;Triangle"</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;appInfo.applicationVersion&nbsp;=&nbsp;VK_MAKE_VERSION(1,&nbsp;0,&nbsp;0);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;appInfo.pEngineName&nbsp;=&nbsp;<span class="string">"No&nbsp;Engine"</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;appInfo.engineVersion&nbsp;=&nbsp;VK_MAKE_VERSION(1,&nbsp;0,&nbsp;0);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;appInfo.apiVersion&nbsp;=&nbsp;VK_API_VERSION_1_0;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;appInfo.pNext&nbsp;=&nbsp;NULL;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;3.2&nbsp;get&nbsp;required&nbsp;extensions&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;uint32_t&nbsp;glfwExtensionCount&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">const</span><span>&nbsp;</span><span class="datatypes">char</span><span>**&nbsp;glfwExtensions;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;glfwExtensions&nbsp;=&nbsp;glfwGetRequiredInstanceExtensions(&amp;glfwExtensionCount);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;3.3&nbsp;add&nbsp;validation&nbsp;layer&nbsp;required&nbsp;extension&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;std::vector&lt;<span class="keyword">const</span><span>&nbsp;</span><span class="datatypes">char</span><span>*&gt;&nbsp;required_extensions(glfwExtensions,&nbsp;glfwExtensions&nbsp;+&nbsp;glfwExtensionCount);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;required_extensions.push_back(VK_EXT_DEBUG_UTILS_EXTENSION_NAME);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;3.4&nbsp;fill&nbsp;the&nbsp;instance&nbsp;create&nbsp;info&nbsp;and&nbsp;create</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkInstanceCreateInfo&nbsp;instanceCreateInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;instanceCreateInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_INSTANCE_CREATE_INFO;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;instanceCreateInfo.pApplicationInfo&nbsp;=&nbsp;&amp;appInfo;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;instanceCreateInfo.enabledExtensionCount&nbsp;=&nbsp;<span class="keyword">static_cast</span><span>&lt;uint32_t&gt;(required_extensions.size());&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;instanceCreateInfo.ppEnabledExtensionNames&nbsp;=&nbsp;required_extensions.data();&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;instanceCreateInfo.enabledLayerCount&nbsp;=&nbsp;validationLayerNames.size();&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;instanceCreateInfo.ppEnabledLayerNames&nbsp;=&nbsp;validationLayerNames.data();&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(vkCreateInstance(&amp;instanceCreateInfo,&nbsp;nullptr,&nbsp;&amp;instance)&nbsp;!=&nbsp;VK_SUCCESS)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"failed&nbsp;to&nbsp;create&nbsp;instance!"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;3.5&nbsp;set&nbsp;up&nbsp;debug&nbsp;messenger</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkDebugUtilsMessengerCreateInfoEXT&nbsp;messengerCreateInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;messengerCreateInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_DEBUG_UTILS_MESSENGER_CREATE_INFO_EXT;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;messengerCreateInfo.messageSeverity&nbsp;=&nbsp;VK_DEBUG_UTILS_MESSAGE_SEVERITY_VERBOSE_BIT_EXT&nbsp;|&nbsp;VK_DEBUG_UTILS_MESSAGE_SEVERITY_WARNING_BIT_EXT&nbsp;|&nbsp;VK_DEBUG_UTILS_MESSAGE_SEVERITY_ERROR_BIT_EXT;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;messengerCreateInfo.messageType&nbsp;=&nbsp;VK_DEBUG_UTILS_MESSAGE_TYPE_GENERAL_BIT_EXT&nbsp;|&nbsp;VK_DEBUG_UTILS_MESSAGE_TYPE_VALIDATION_BIT_EXT&nbsp;|&nbsp;VK_DEBUG_UTILS_MESSAGE_TYPE_PERFORMANCE_BIT_EXT;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;messengerCreateInfo.pfnUserCallback&nbsp;=&nbsp;debugCallback;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;messengerCreateInfo.pUserData&nbsp;=&nbsp;nullptr;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;auto&nbsp;func&nbsp;=&nbsp;(PFN_vkCreateDebugUtilsMessengerEXT)vkGetInstanceProcAddr(instance,&nbsp;<span class="string">"vkCreateDebugUtilsMessengerEXT"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(func&nbsp;==&nbsp;NULL)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"get&nbsp;vkCreateDebugUtilsMessengerEXT&nbsp;fault."</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkDebugUtilsMessengerEXT&nbsp;debugMessenger;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(func(instance,&nbsp;&amp;messengerCreateInfo,&nbsp;NULL,&nbsp;&amp;debugMessenger)&nbsp;!=&nbsp;VK_SUCCESS)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"set&nbsp;debug&nbsp;messenger&nbsp;fault&nbsp;.&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;4.&nbsp;create&nbsp;physical&nbsp;device</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;4.1&nbsp;enumerate&nbsp;all&nbsp;physical&nbsp;device&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkPhysicalDevice&nbsp;physicalDevice&nbsp;=&nbsp;VK_NULL_HANDLE;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;uint32_t&nbsp;deviceCount&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vkEnumeratePhysicalDevices(instance,&nbsp;&amp;deviceCount,&nbsp;NULL);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(deviceCount&nbsp;==&nbsp;0)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"failed&nbsp;to&nbsp;find&nbsp;physical&nbsp;device&nbsp;."</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;std::vector&lt;VkPhysicalDevice&gt;&nbsp;devices(deviceCount);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vkEnumeratePhysicalDevices(instance,&nbsp;&amp;deviceCount,&nbsp;devices.data());&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;4.2&nbsp;choose&nbsp;a&nbsp;suitable&nbsp;physical&nbsp;device&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(</span><span class="keyword">const</span><span>&nbsp;auto&amp;&nbsp;device&nbsp;:&nbsp;devices)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkPhysicalDeviceProperties&nbsp;deviceProperties;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkPhysicalDeviceFeatures&nbsp;deviceFeatures;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vkGetPhysicalDeviceFeatures(device,&nbsp;&amp;deviceFeatures);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vkGetPhysicalDeviceProperties(device,&nbsp;&amp;deviceProperties);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(deviceProperties.deviceType&nbsp;==&nbsp;VK_PHYSICAL_DEVICE_TYPE_DISCRETE_GPU&nbsp;&amp;&amp;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deviceFeatures.geometryShader)&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;physicalDevice&nbsp;=&nbsp;device;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">break</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(physicalDevice&nbsp;==&nbsp;VK_NULL_HANDLE)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"no&nbsp;suitable&nbsp;device."</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;5.&nbsp;create&nbsp;surface&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkSurfaceKHR&nbsp;surface;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkWin32SurfaceCreateInfoKHR&nbsp;surfaceCreateInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;surfaceCreateInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_WIN32_SURFACE_CREATE_INFO_KHR;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;surfaceCreateInfo.hwnd&nbsp;=&nbsp;glfwGetWin32Window(window);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;surfaceCreateInfo.hinstance&nbsp;=&nbsp;GetModuleHandle(nullptr);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(vkCreateWin32SurfaceKHR(instance,&nbsp;&amp;surfaceCreateInfo,&nbsp;NULL,&nbsp;&amp;surface))&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"&nbsp;failed&nbsp;to&nbsp;create&nbsp;window&nbsp;surface&nbsp;."</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;6.&nbsp;prepare&nbsp;for&nbsp;creating&nbsp;device&nbsp;queue</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;6.1&nbsp;find&nbsp;a&nbsp;queueFamily&nbsp;which&nbsp;can&nbsp;be&nbsp;a&nbsp;graphics&nbsp;queue&nbsp;and&nbsp;a&nbsp;present&nbsp;queue</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;uint32_t&nbsp;queueFamilyCount&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vkGetPhysicalDeviceQueueFamilyProperties(physicalDevice,&nbsp;&amp;queueFamilyCount,&nbsp;NULL);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;std::vector&lt;VkQueueFamilyProperties&gt;&nbsp;queueFamilies(queueFamilyCount);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vkGetPhysicalDeviceQueueFamilyProperties(physicalDevice,&nbsp;&amp;queueFamilyCount,&nbsp;queueFamilies.data());&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="datatypes">int</span><span>&nbsp;i&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="datatypes">int</span><span>&nbsp;queue_ind&nbsp;=&nbsp;-1;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(</span><span class="keyword">const</span><span>&nbsp;auto&amp;&nbsp;queueFamily&nbsp;:&nbsp;queueFamilies)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkBool32&nbsp;presentSupport&nbsp;=&nbsp;<span class="keyword">false</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vkGetPhysicalDeviceSurfaceSupportKHR(physicalDevice,&nbsp;i,&nbsp;surface,&nbsp;&amp;presentSupport);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(queueFamily.queueCount&nbsp;&gt;&nbsp;0&nbsp;&amp;&amp;&nbsp;queueFamily.queueFlags&nbsp;&amp;&nbsp;VK_QUEUE_GRAPHICS_BIT&nbsp;&amp;&amp;&nbsp;presentSupport)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;queue_ind&nbsp;=&nbsp;i;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i++;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(queue_ind&nbsp;==&nbsp;-1)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"No&nbsp;suitable&nbsp;queue&nbsp;."</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;6.2&nbsp;fill&nbsp;VkDeviceQueueCreateInfo&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkDeviceQueueCreateInfo&nbsp;queueCreateInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;queueCreateInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_DEVICE_QUEUE_CREATE_INFO;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;queueCreateInfo.queueFamilyIndex&nbsp;=&nbsp;queue_ind;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;queueCreateInfo.queueCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="datatypes">float</span><span>&nbsp;queuePriority&nbsp;=&nbsp;1.0f;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;queueCreateInfo.pQueuePriorities&nbsp;=&nbsp;&amp;queuePriority;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;7.&nbsp;create&nbsp;logical&nbsp;device&nbsp;and&nbsp;use&nbsp;it&nbsp;to&nbsp;create&nbsp;some&nbsp;resources&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;7.1&nbsp;check&nbsp;whether&nbsp;the&nbsp;physical&nbsp;device&nbsp;support&nbsp;the&nbsp;required&nbsp;extensions&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">const</span><span>&nbsp;std::vector&lt;</span><span class="keyword">const</span><span>&nbsp;</span><span class="datatypes">char</span><span>*&gt;&nbsp;requireExtensions&nbsp;=&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VK_KHR_SWAPCHAIN_EXTENSION_NAME&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;uint32_t&nbsp;availableExtensionCount;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;vkEnumerateDeviceExtensionProperties(physicalDevice,&nbsp;NULL,&nbsp;&amp;availableExtensionCount,&nbsp;NULL);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;std::vector&lt;VkExtensionProperties&gt;&nbsp;availableExtensions(availableExtensionCount);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;vkEnumerateDeviceExtensionProperties(physicalDevice,&nbsp;NULL,&nbsp;&amp;availableExtensionCount,&nbsp;availableExtensions.data());&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;std::set&lt;std::string&gt;&nbsp;requireExtensionNames(requireExtensions.begin(),&nbsp;requireExtensions.end());&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(</span><span class="keyword">const</span><span>&nbsp;auto&amp;&nbsp;extension&nbsp;:&nbsp;availableExtensions)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;requireExtensionNames.erase(extension.extensionName);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(!requireExtensionNames.empty())&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"extension&nbsp;not&nbsp;fulfill"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;7.2&nbsp;create&nbsp;logical&nbsp;device&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkPhysicalDeviceFeatures&nbsp;deviceFeatures&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkDeviceCreateInfo&nbsp;deviceCreateInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;deviceCreateInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_DEVICE_CREATE_INFO;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;deviceCreateInfo.pQueueCreateInfos&nbsp;=&nbsp;&amp;queueCreateInfo;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;deviceCreateInfo.queueCreateInfoCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;deviceCreateInfo.pEnabledFeatures&nbsp;=&nbsp;&amp;deviceFeatures;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;deviceCreateInfo.enabledExtensionCount&nbsp;=&nbsp;requireExtensions.size();&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;deviceCreateInfo.ppEnabledExtensionNames&nbsp;=&nbsp;requireExtensions.data();&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(vkCreateDevice(physicalDevice,&nbsp;&amp;deviceCreateInfo,&nbsp;NULL,&nbsp;&amp;logicalDevice)&nbsp;!=&nbsp;VK_SUCCESS)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"failed&nbsp;to&nbsp;create&nbsp;logical&nbsp;device."</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;7.3&nbsp;retrieve&nbsp;device&nbsp;queue&nbsp;by&nbsp;logical&nbsp;device&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;vkGetDeviceQueue(logicalDevice,&nbsp;queue_ind,&nbsp;0,&nbsp;&amp;graphicsQueue);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;7.4&nbsp;create&nbsp;swap&nbsp;chain&nbsp;by&nbsp;logical&nbsp;device&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">struct</span><span>&nbsp;SwapChainSupportDetails&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkSurfaceCapabilitiesKHR&nbsp;capabilities;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::vector&lt;VkSurfaceFormatKHR&gt;&nbsp;formats;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::vector&lt;VkPresentModeKHR&gt;&nbsp;presentModes;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;SwapChainSupportDetails&nbsp;details;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;vkGetPhysicalDeviceSurfaceCapabilitiesKHR(physicalDevice,&nbsp;surface,&nbsp;&amp;details.capabilities);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;7.4.1&nbsp;choose&nbsp;the&nbsp;surface&nbsp;format&nbsp;and&nbsp;present&nbsp;mode&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;uint32_t&nbsp;formatCount;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;vkGetPhysicalDeviceSurfaceFormatsKHR(physicalDevice,&nbsp;surface,&nbsp;&amp;formatCount,&nbsp;NULL);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(formatCount&nbsp;!=&nbsp;0)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;details.formats.resize(formatCount);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vkGetPhysicalDeviceSurfaceFormatsKHR(physicalDevice,&nbsp;surface,&nbsp;&amp;formatCount,&nbsp;details.formats.data());&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;uint32_t&nbsp;presentModeCount;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vkGetPhysicalDeviceSurfacePresentModesKHR(physicalDevice,&nbsp;surface,&nbsp;&amp;presentModeCount,&nbsp;NULL);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(presentModeCount&nbsp;!=&nbsp;0)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;details.presentModes.resize(presentModeCount);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vkGetPhysicalDeviceSurfacePresentModesKHR(physicalDevice,&nbsp;surface,&nbsp;&amp;presentModeCount,&nbsp;details.presentModes.data());&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(formatCount&nbsp;==&nbsp;0&nbsp;||&nbsp;presentModeCount&nbsp;==&nbsp;0)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"&nbsp;no&nbsp;suitable&nbsp;format&nbsp;or&nbsp;present&nbsp;mode&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="datatypes">int</span><span>&nbsp;format_ind&nbsp;=&nbsp;-1;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(</span><span class="keyword">const</span><span>&nbsp;auto&amp;&nbsp;availableFormat&nbsp;:&nbsp;details.formats)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;format_ind++;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(availableFormat.format&nbsp;==&nbsp;VK_FORMAT_R8G8B8A8_UNORM&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;availableFormat.colorSpace&nbsp;==&nbsp;VK_COLOR_SPACE_SRGB_NONLINEAR_KHR)&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">break</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="datatypes">int</span><span>&nbsp;present_mode_ind&nbsp;=&nbsp;-1;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(</span><span class="keyword">const</span><span>&nbsp;auto&amp;&nbsp;availablePresentMode&nbsp;:&nbsp;details.presentModes)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;present_mode_ind++;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(availablePresentMode&nbsp;==&nbsp;VK_PRESENT_MODE_MAILBOX_KHR)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">break</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;7.4.2&nbsp;choose&nbsp;the&nbsp;extent&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkExtent2D&nbsp;actualExtent;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;actualExtent.width&nbsp;=&nbsp;std::fmax(details.capabilities.minImageExtent.width,&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::fmin(details.capabilities.maxImageExtent.width,&nbsp;width));&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;actualExtent.height&nbsp;=&nbsp;std::fmax(details.capabilities.minImageExtent.height,&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::fmin(details.capabilities.maxImageExtent.height,&nbsp;height));&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;uint32_t&nbsp;imageCount&nbsp;=&nbsp;details.capabilities.minImageCount&nbsp;+&nbsp;1;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(details.capabilities.maxImageCount&nbsp;&gt;&nbsp;0&nbsp;&amp;&amp;&nbsp;imageCount&nbsp;&gt;&nbsp;details.capabilities.maxImageCount)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imageCount&nbsp;=&nbsp;details.capabilities.maxImageCount;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;7.4.3&nbsp;fill&nbsp;the&nbsp;VkSwapchainCreateInfoKHR&nbsp;and&nbsp;create&nbsp;.</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkSwapchainCreateInfoKHR&nbsp;swapChainCreateInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainCreateInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_SWAPCHAIN_CREATE_INFO_KHR;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainCreateInfo.surface&nbsp;=&nbsp;surface;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainCreateInfo.minImageCount&nbsp;=&nbsp;imageCount;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainCreateInfo.imageFormat&nbsp;=&nbsp;details.formats[format_ind].format;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainCreateInfo.imageColorSpace&nbsp;=&nbsp;details.formats[format_ind].colorSpace;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainCreateInfo.imageExtent&nbsp;=&nbsp;actualExtent;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainCreateInfo.imageArrayLayers&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainCreateInfo.imageUsage&nbsp;=&nbsp;VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainCreateInfo.imageSharingMode&nbsp;=&nbsp;VK_SHARING_MODE_EXCLUSIVE;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainCreateInfo.preTransform&nbsp;=&nbsp;details.capabilities.currentTransform;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainCreateInfo.compositeAlpha&nbsp;=&nbsp;VK_COMPOSITE_ALPHA_OPAQUE_BIT_KHR;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainCreateInfo.presentMode&nbsp;=&nbsp;details.presentModes[present_mode_ind];&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainCreateInfo.clipped&nbsp;=&nbsp;VK_TRUE;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainCreateInfo.oldSwapchain&nbsp;=&nbsp;VK_NULL_HANDLE;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(vkCreateSwapchainKHR(logicalDevice,&nbsp;&amp;swapChainCreateInfo,&nbsp;NULL,&nbsp;&amp;swapChain)&nbsp;!=&nbsp;VK_SUCCESS)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"swap&nbsp;chain&nbsp;create&nbsp;fault&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//7.5&nbsp;create&nbsp;swapchain&nbsp;ImageView&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;std::vector&lt;VkImage&gt;&nbsp;swapChainImages;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vkGetSwapchainImagesKHR(logicalDevice,&nbsp;swapChain,&nbsp;&amp;imageCount,&nbsp;NULL);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainImages.resize(imageCount);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vkGetSwapchainImagesKHR(logicalDevice,&nbsp;swapChain,&nbsp;&amp;imageCount,&nbsp;swapChainImages.data());&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;std::vector&lt;VkImageView&gt;&nbsp;swapChainImageViews;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainImageViews.resize(swapChainImages.size());&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(</span><span class="datatypes">size_t</span><span>&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;swapChainImages.size();&nbsp;i++)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkImageViewCreateInfo&nbsp;createInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_IMAGE_VIEW_CREATE_INFO;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createInfo.image&nbsp;=&nbsp;swapChainImages[i];&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createInfo.viewType&nbsp;=&nbsp;VK_IMAGE_VIEW_TYPE_2D;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createInfo.format&nbsp;=&nbsp;swapChainCreateInfo.imageFormat;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createInfo.components.r&nbsp;=&nbsp;VK_COMPONENT_SWIZZLE_IDENTITY;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createInfo.components.g&nbsp;=&nbsp;VK_COMPONENT_SWIZZLE_IDENTITY;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createInfo.components.b&nbsp;=&nbsp;VK_COMPONENT_SWIZZLE_IDENTITY;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createInfo.components.a&nbsp;=&nbsp;VK_COMPONENT_SWIZZLE_IDENTITY;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createInfo.subresourceRange.aspectMask&nbsp;=&nbsp;VK_IMAGE_ASPECT_COLOR_BIT;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createInfo.subresourceRange.baseMipLevel&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createInfo.subresourceRange.levelCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createInfo.subresourceRange.baseArrayLayer&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createInfo.subresourceRange.layerCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(vkCreateImageView(logicalDevice,&nbsp;&amp;createInfo,&nbsp;NULL,&nbsp;&amp;swapChainImageViews[i])&nbsp;!=&nbsp;VK_SUCCESS)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"failed&nbsp;to&nbsp;create&nbsp;image&nbsp;view."</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//7.6&nbsp;create&nbsp;shader&nbsp;module</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;auto&nbsp;loadShaderByteCode&nbsp;=&nbsp;[](<span class="keyword">const</span><span>&nbsp;std::string&amp;&nbsp;fileName)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::ifstream&nbsp;loadFile(fileName,&nbsp;std::ios::ate&nbsp;|&nbsp;std::ios::binary);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(!loadFile.is_open())&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"failed&nbsp;to&nbsp;open&nbsp;file!"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="datatypes">size_t</span><span>&nbsp;fileSize&nbsp;=&nbsp;(</span><span class="datatypes">size_t</span><span>)loadFile.tellg();&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::vector&lt;<span class="datatypes">char</span><span>&gt;&nbsp;buffer(fileSize);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loadFile.seekg(0);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loadFile.read(buffer.data(),&nbsp;fileSize);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loadFile.close();&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;buffer;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;auto&nbsp;vertShaderCode&nbsp;=&nbsp;loadShaderByteCode(<span class="string">"vert.spv"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;auto&nbsp;fragShaderCode&nbsp;=&nbsp;loadShaderByteCode(<span class="string">"frag.spv"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;auto&nbsp;createShaderModule&nbsp;=&nbsp;[](<span class="keyword">const</span><span>&nbsp;std::vector&lt;</span><span class="datatypes">char</span><span>&gt;&amp;&nbsp;code)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkShaderModuleCreateInfo&nbsp;createInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_SHADER_MODULE_CREATE_INFO;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createInfo.codeSize&nbsp;=&nbsp;code.size();&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createInfo.pCode&nbsp;=&nbsp;<span class="keyword">reinterpret_cast</span><span>&lt;</span><span class="keyword">const</span><span>&nbsp;uint32_t*&gt;(code.data());&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkShaderModule&nbsp;shaderModule;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(vkCreateShaderModule(logicalDevice,&nbsp;&amp;createInfo,&nbsp;NULL,&nbsp;&amp;shaderModule)&nbsp;!=&nbsp;VK_SUCCESS)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"failed&nbsp;to&nbsp;create&nbsp;shader&nbsp;module&nbsp;."</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;shaderModule;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkShaderModule&nbsp;vertShaderModule&nbsp;=&nbsp;createShaderModule(vertShaderCode);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkShaderModule&nbsp;fragShaderModule&nbsp;=&nbsp;createShaderModule(fragShaderCode);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;7.7&nbsp;create&nbsp;pipeline&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;7.7.1&nbsp;prepare&nbsp;shader&nbsp;stage</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkPipelineShaderStageCreateInfo&nbsp;vertShaderStageInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;vertShaderStageInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_PIPELINE_SHADER_STAGE_CREATE_INFO;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vertShaderStageInfo.stage&nbsp;=&nbsp;VK_SHADER_STAGE_VERTEX_BIT;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;vertShaderStageInfo.module&nbsp;=&nbsp;vertShaderModule;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vertShaderStageInfo.pName&nbsp;=&nbsp;<span class="string">"main"</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkPipelineShaderStageCreateInfo&nbsp;fragShaderStageInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;fragShaderStageInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_PIPELINE_SHADER_STAGE_CREATE_INFO;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;fragShaderStageInfo.stage&nbsp;=&nbsp;VK_SHADER_STAGE_FRAGMENT_BIT;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;fragShaderStageInfo.module&nbsp;=&nbsp;fragShaderModule;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;fragShaderStageInfo.pName&nbsp;=&nbsp;<span class="string">"main"</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkPipelineShaderStageCreateInfo&nbsp;shaderStages[]&nbsp;=&nbsp;{&nbsp;vertShaderStageInfo&nbsp;,&nbsp;fragShaderStageInfo&nbsp;};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//7.7.2&nbsp;prepare&nbsp;vertex&nbsp;input&nbsp;state</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkPipelineVertexInputStateCreateInfo&nbsp;vertexInputInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vertexInputInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_PIPELINE_VERTEX_INPUT_STATE_CREATE_INFO;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;vertexInputInfo.vertexBindingDescriptionCount&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vertexInputInfo.pVertexBindingDescriptions&nbsp;=&nbsp;NULL;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;vertexInputInfo.vertexAttributeDescriptionCount&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vertexInputInfo.pVertexAttributeDescriptions&nbsp;=&nbsp;NULL;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//7.7.3&nbsp;prepare&nbsp;input&nbsp;assembly&nbsp;state</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkPipelineInputAssemblyStateCreateInfo&nbsp;inputAssembly&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;inputAssembly.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_PIPELINE_INPUT_ASSEMBLY_STATE_CREATE_INFO;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;inputAssembly.topology&nbsp;=&nbsp;VK_PRIMITIVE_TOPOLOGY_TRIANGLE_LIST;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;inputAssembly.primitiveRestartEnable&nbsp;=&nbsp;VK_FALSE;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//7.7.4&nbsp;prepare&nbsp;viewport&nbsp;and&nbsp;scissor&nbsp;state</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkViewport&nbsp;viewport&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;viewport.x&nbsp;=&nbsp;0.0f;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;viewport.y&nbsp;=&nbsp;0.0f;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;viewport.width&nbsp;=&nbsp;width;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;viewport.height&nbsp;=&nbsp;height;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;viewport.minDepth&nbsp;=&nbsp;0.0f;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;viewport.maxDepth&nbsp;=&nbsp;1.0f;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkRect2D&nbsp;scissor&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;scissor.offset&nbsp;=&nbsp;{&nbsp;0&nbsp;,&nbsp;0&nbsp;};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;scissor.extent&nbsp;=&nbsp;swapChainCreateInfo.imageExtent;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkPipelineViewportStateCreateInfo&nbsp;viewportState&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;viewportState.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_PIPELINE_VIEWPORT_STATE_CREATE_INFO;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;viewportState.viewportCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;viewportState.pViewports&nbsp;=&nbsp;&amp;viewport;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;viewportState.scissorCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;viewportState.pScissors&nbsp;=&nbsp;&amp;scissor;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//7.7.5&nbsp;prepare&nbsp;rasterization&nbsp;state&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkPipelineRasterizationStateCreateInfo&nbsp;rasterizer&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;rasterizer.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_PIPELINE_RASTERIZATION_STATE_CREATE_INFO;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;rasterizer.depthClampEnable&nbsp;=&nbsp;VK_FALSE;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;rasterizer.rasterizerDiscardEnable&nbsp;=&nbsp;VK_FALSE;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;rasterizer.polygonMode&nbsp;=&nbsp;VK_POLYGON_MODE_FILL;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;rasterizer.lineWidth&nbsp;=&nbsp;1.0f;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;rasterizer.cullMode&nbsp;=&nbsp;VK_CULL_MODE_BACK_BIT;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;rasterizer.frontFace&nbsp;=&nbsp;VK_FRONT_FACE_CLOCKWISE;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;rasterizer.depthBiasEnable&nbsp;=&nbsp;VK_FALSE;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;rasterizer.depthBiasConstantFactor&nbsp;=&nbsp;0.0f;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;rasterizer.depthBiasClamp&nbsp;=&nbsp;0.0f;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;rasterizer.depthBiasSlopeFactor&nbsp;=&nbsp;0.0f;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//7.7.6&nbsp;prepare&nbsp;multisample&nbsp;state&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkPipelineMultisampleStateCreateInfo&nbsp;multisampling&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;multisampling.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_PIPELINE_MULTISAMPLE_STATE_CREATE_INFO;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;multisampling.sampleShadingEnable&nbsp;=&nbsp;VK_FALSE;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;multisampling.rasterizationSamples&nbsp;=&nbsp;VK_SAMPLE_COUNT_1_BIT;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;multisampling.minSampleShading&nbsp;=&nbsp;1.0f;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;multisampling.pSampleMask&nbsp;=&nbsp;nullptr;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;multisampling.alphaToCoverageEnable&nbsp;=&nbsp;VK_FALSE;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;multisampling.alphaToOneEnable&nbsp;=&nbsp;VK_FALSE;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//7.7.7&nbsp;prepare&nbsp;color&nbsp;blend&nbsp;state</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkPipelineColorBlendAttachmentState&nbsp;colorBlendAttachment&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlendAttachment.colorWriteMask&nbsp;=&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VK_COLOR_COMPONENT_R_BIT&nbsp;|&nbsp;VK_COLOR_COMPONENT_G_BIT&nbsp;|&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VK_COLOR_COMPONENT_B_BIT&nbsp;|&nbsp;VK_COLOR_COMPONENT_A_BIT;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlendAttachment.blendEnable&nbsp;=&nbsp;VK_FALSE;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlendAttachment.srcColorBlendFactor&nbsp;=&nbsp;VK_BLEND_FACTOR_ONE;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlendAttachment.dstColorBlendFactor&nbsp;=&nbsp;VK_BLEND_FACTOR_ZERO;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlendAttachment.colorBlendOp&nbsp;=&nbsp;VK_BLEND_OP_ADD;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlendAttachment.srcAlphaBlendFactor&nbsp;=&nbsp;VK_BLEND_FACTOR_ONE;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlendAttachment.dstAlphaBlendFactor&nbsp;=&nbsp;VK_BLEND_FACTOR_ZERO;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlendAttachment.alphaBlendOp&nbsp;=&nbsp;VK_BLEND_OP_ADD;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkPipelineColorBlendStateCreateInfo&nbsp;colorBlending&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlending.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_PIPELINE_COLOR_BLEND_STATE_CREATE_INFO;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlending.logicOpEnable&nbsp;=&nbsp;VK_FALSE;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlending.logicOp&nbsp;=&nbsp;VK_LOGIC_OP_COPY;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlending.attachmentCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlending.pAttachments&nbsp;=&nbsp;&amp;colorBlendAttachment;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlending.blendConstants[0]&nbsp;=&nbsp;0.0f;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlending.blendConstants[1]&nbsp;=&nbsp;0.0f;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlending.blendConstants[2]&nbsp;=&nbsp;0.0f;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;colorBlending.blendConstants[3]&nbsp;=&nbsp;0.0f;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//7.7.8&nbsp;create&nbsp;render&nbsp;pass</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkAttachmentDescription&nbsp;colorAttachment&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;colorAttachment.format&nbsp;=&nbsp;swapChainCreateInfo.imageFormat;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;colorAttachment.samples&nbsp;=&nbsp;VK_SAMPLE_COUNT_1_BIT;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;colorAttachment.loadOp&nbsp;=&nbsp;VK_ATTACHMENT_LOAD_OP_CLEAR;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;colorAttachment.storeOp&nbsp;=&nbsp;VK_ATTACHMENT_STORE_OP_STORE;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;colorAttachment.stencilLoadOp&nbsp;=&nbsp;VK_ATTACHMENT_LOAD_OP_DONT_CARE;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;colorAttachment.stencilStoreOp&nbsp;=&nbsp;VK_ATTACHMENT_STORE_OP_DONT_CARE;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;colorAttachment.initialLayout&nbsp;=&nbsp;VK_IMAGE_LAYOUT_UNDEFINED;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;colorAttachment.finalLayout&nbsp;=&nbsp;VK_IMAGE_LAYOUT_PRESENT_SRC_KHR;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkAttachmentReference&nbsp;colorAttachmentRef&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;colorAttachmentRef.attachment&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;colorAttachmentRef.layout&nbsp;=&nbsp;VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkSubpassDescription&nbsp;subpass&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;subpass.pipelineBindPoint&nbsp;=&nbsp;VK_PIPELINE_BIND_POINT_GRAPHICS;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;subpass.colorAttachmentCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;subpass.pColorAttachments&nbsp;=&nbsp;&amp;colorAttachmentRef;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkRenderPass&nbsp;renderPass;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkRenderPassCreateInfo&nbsp;renderPassInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;renderPassInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_RENDER_PASS_CREATE_INFO;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;renderPassInfo.attachmentCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;renderPassInfo.pAttachments&nbsp;=&nbsp;&amp;colorAttachment;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;renderPassInfo.subpassCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;renderPassInfo.pSubpasses&nbsp;=&nbsp;&amp;subpass;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;renderPassInfo.dependencyCount&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;renderPassInfo.pDependencies&nbsp;=&nbsp;NULL;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(vkCreateRenderPass(logicalDevice,&nbsp;&amp;renderPassInfo,&nbsp;NULL,&nbsp;&amp;renderPass)&nbsp;!=&nbsp;VK_SUCCESS)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"failed&nbsp;to&nbsp;create&nbsp;render&nbsp;pass!"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//7.7.9&nbsp;create&nbsp;pipeline&nbsp;layout&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkPipelineLayout&nbsp;pipelineLayout;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkPipelineLayoutCreateInfo&nbsp;pipelineLayoutInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineLayoutInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_PIPELINE_LAYOUT_CREATE_INFO;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineLayoutInfo.setLayoutCount&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineLayoutInfo.pushConstantRangeCount&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(vkCreatePipelineLayout(logicalDevice,&nbsp;&amp;pipelineLayoutInfo,&nbsp;NULL,&nbsp;&amp;pipelineLayout)&nbsp;!=&nbsp;VK_SUCCESS)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"failed&nbsp;to&nbsp;create&nbsp;graphics&nbsp;pipeline&nbsp;.&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;7.7.10&nbsp;merge&nbsp;all&nbsp;the&nbsp;state&nbsp;and&nbsp;create&nbsp;graphics&nbsp;pipeline&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkGraphicsPipelineCreateInfo&nbsp;pipelineInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_GRAPHICS_PIPELINE_CREATE_INFO;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineInfo.stageCount&nbsp;=&nbsp;2;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineInfo.pStages&nbsp;=&nbsp;shaderStages;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineInfo.pVertexInputState&nbsp;=&nbsp;&amp;vertexInputInfo;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineInfo.pInputAssemblyState&nbsp;=&nbsp;&amp;inputAssembly;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineInfo.pViewportState&nbsp;=&nbsp;&amp;viewportState;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineInfo.pRasterizationState&nbsp;=&nbsp;&amp;rasterizer;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineInfo.pMultisampleState&nbsp;=&nbsp;&amp;multisampling;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineInfo.pDepthStencilState&nbsp;=&nbsp;NULL;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineInfo.pColorBlendState&nbsp;=&nbsp;&amp;colorBlending;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineInfo.pDynamicState&nbsp;=&nbsp;NULL;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineInfo.renderPass&nbsp;=&nbsp;renderPass;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineInfo.subpass&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineInfo.basePipelineHandle&nbsp;=&nbsp;VK_NULL_HANDLE;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;pipelineInfo.layout&nbsp;=&nbsp;pipelineLayout;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkPipeline&nbsp;graphicsPipeline;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(vkCreateGraphicsPipelines(logicalDevice,&nbsp;VK_NULL_HANDLE,&nbsp;1,&nbsp;&amp;pipelineInfo,&nbsp;NULL,&nbsp;&amp;graphicsPipeline)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!=&nbsp;VK_SUCCESS)&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"failed&nbsp;to&nbsp;create&nbsp;graphics&nbsp;pipeline"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vkDestroyShaderModule(logicalDevice,&nbsp;fragShaderModule,&nbsp;nullptr);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;vkDestroyShaderModule(logicalDevice,&nbsp;vertShaderModule,&nbsp;nullptr);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//7.7.11&nbsp;create&nbsp;frame&nbsp;buffer&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;std::vector&lt;VkFramebuffer&gt;&nbsp;swapChainFrameBuffer;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;swapChainFrameBuffer.resize(swapChainImageViews.size());&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(</span><span class="datatypes">size_t</span><span>&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;swapChainImageViews.size();&nbsp;i++)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkImageView&nbsp;attachments[]&nbsp;=&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swapChainImageViews[i]&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkFramebufferCreateInfo&nbsp;frameBufferInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frameBufferInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_FRAMEBUFFER_CREATE_INFO;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frameBufferInfo.renderPass&nbsp;=&nbsp;renderPass;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frameBufferInfo.width&nbsp;=&nbsp;width;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frameBufferInfo.height&nbsp;=&nbsp;height;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frameBufferInfo.layers&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frameBufferInfo.pAttachments&nbsp;=&nbsp;attachments;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frameBufferInfo.attachmentCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(vkCreateFramebuffer(logicalDevice,&nbsp;&amp;frameBufferInfo,&nbsp;NULL,&nbsp;&amp;swapChainFrameBuffer[i])&nbsp;!=&nbsp;VK_SUCCESS)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"create&nbsp;frame&nbsp;buffer&nbsp;fault&nbsp;.&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//7.7.12&nbsp;create&nbsp;command&nbsp;buffer&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkCommandPool&nbsp;commandPool;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkCommandPoolCreateInfo&nbsp;poolCreateInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;poolCreateInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_COMMAND_POOL_CREATE_INFO;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;poolCreateInfo.queueFamilyIndex&nbsp;=&nbsp;queue_ind;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;poolCreateInfo.flags&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(vkCreateCommandPool(logicalDevice,&nbsp;&amp;poolCreateInfo,&nbsp;NULL,&nbsp;&amp;commandPool)&nbsp;!=&nbsp;VK_SUCCESS)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"create&nbsp;command&nbsp;pool&nbsp;fault&nbsp;.&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;commandBuffer.resize(swapChainFrameBuffer.size());&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;VkCommandBufferAllocateInfo&nbsp;allocInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;allocInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_COMMAND_BUFFER_ALLOCATE_INFO;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;allocInfo.commandPool&nbsp;=&nbsp;commandPool;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;allocInfo.level&nbsp;=&nbsp;VK_COMMAND_BUFFER_LEVEL_PRIMARY;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;allocInfo.commandBufferCount&nbsp;=&nbsp;(uint32_t)commandBuffer.size();&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(vkAllocateCommandBuffers(logicalDevice,&nbsp;&amp;allocInfo,&nbsp;commandBuffer.data())&nbsp;!=&nbsp;VK_SUCCESS)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"alloc&nbsp;command&nbsp;buffer&nbsp;fault&nbsp;.&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(</span><span class="datatypes">size_t</span><span>&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;commandBuffer.size();&nbsp;i++)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkCommandBufferBeginInfo&nbsp;beginInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beginInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_COMMAND_BUFFER_BEGIN_INFO;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beginInfo.flags&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(vkBeginCommandBuffer(commandBuffer[i],&nbsp;&amp;beginInfo)&nbsp;!=&nbsp;VK_SUCCESS)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"failed&nbsp;to&nbsp;begin&nbsp;recording&nbsp;command&nbsp;buffer&nbsp;.&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkRenderPassBeginInfo&nbsp;renderPassBeginInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;renderPassBeginInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_RENDER_PASS_BEGIN_INFO;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;renderPassBeginInfo.renderPass&nbsp;=&nbsp;renderPass;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;renderPassBeginInfo.framebuffer&nbsp;=&nbsp;swapChainFrameBuffer[i];&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;renderPassBeginInfo.renderArea.offset&nbsp;=&nbsp;{&nbsp;0&nbsp;,&nbsp;0&nbsp;};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;renderPassBeginInfo.renderArea.extent&nbsp;=&nbsp;swapChainCreateInfo.imageExtent;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkClearValue&nbsp;clearColor&nbsp;=&nbsp;{&nbsp;0.0f&nbsp;,&nbsp;0.0f&nbsp;,&nbsp;0.0f&nbsp;,&nbsp;1.0f&nbsp;};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;renderPassBeginInfo.clearValueCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;renderPassBeginInfo.pClearValues&nbsp;=&nbsp;&amp;clearColor;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vkCmdBeginRenderPass(commandBuffer[i],&nbsp;&amp;renderPassBeginInfo,&nbsp;VK_SUBPASS_CONTENTS_INLINE);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vkCmdBindPipeline(commandBuffer[i],&nbsp;VK_PIPELINE_BIND_POINT_GRAPHICS,&nbsp;graphicsPipeline);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vkCmdDraw(commandBuffer[i],&nbsp;3,&nbsp;1,&nbsp;0,&nbsp;0);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vkCmdEndRenderPass(commandBuffer[i]);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(vkEndCommandBuffer(commandBuffer[i])&nbsp;!=&nbsp;VK_SUCCESS)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"failed&nbsp;to&nbsp;record&nbsp;command&nbsp;buffer&nbsp;.&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;7.7.13&nbsp;create&nbsp;semaphore</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;VkSemaphoreCreateInfo&nbsp;semaphoreInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;semaphoreInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_SEMAPHORE_CREATE_INFO;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(vkCreateSemaphore(logicalDevice,&nbsp;&amp;semaphoreInfo,&nbsp;NULL,&nbsp;&amp;imageAvailableSemaphore)&nbsp;!=&nbsp;VK_SUCCESS&nbsp;||&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vkCreateSemaphore(logicalDevice,&nbsp;&amp;semaphoreInfo,&nbsp;NULL,&nbsp;&amp;renderFinishedSemaphore)&nbsp;!=&nbsp;VK_SUCCESS)&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"failed&nbsp;to&nbsp;create&nbsp;semaphore&nbsp;.&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span><span>&nbsp;(!glfwWindowShouldClose(window))&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glfwPollEvents();&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint32_t&nbsp;imageIndex;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint64_t&nbsp;limit&nbsp;=&nbsp;(std::numeric_limits&lt;uint64_t&gt;::max)();&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vkAcquireNextImageKHR(logicalDevice,&nbsp;swapChain,&nbsp;limit,&nbsp;imageAvailableSemaphore,&nbsp;VK_NULL_HANDLE,&nbsp;&amp;imageIndex);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkSubmitInfo&nbsp;submitInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;submitInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_SUBMIT_INFO;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkSemaphore&nbsp;waitSemaphores[]&nbsp;=&nbsp;{&nbsp;imageAvailableSemaphore&nbsp;};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkPipelineStageFlags&nbsp;waitStages[]&nbsp;=&nbsp;{&nbsp;VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT&nbsp;};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;submitInfo.waitSemaphoreCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;submitInfo.pWaitSemaphores&nbsp;=&nbsp;waitSemaphores;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;submitInfo.pWaitDstStageMask&nbsp;=&nbsp;waitStages;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;submitInfo.commandBufferCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;submitInfo.pCommandBuffers&nbsp;=&nbsp;&amp;commandBuffer[imageIndex];&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkSemaphore&nbsp;signalSemaphores[]&nbsp;=&nbsp;{&nbsp;renderFinishedSemaphore&nbsp;};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;submitInfo.signalSemaphoreCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;submitInfo.pSignalSemaphores&nbsp;=&nbsp;signalSemaphores;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(vkQueueSubmit(graphicsQueue,&nbsp;1,&nbsp;&amp;submitInfo,&nbsp;VK_NULL_HANDLE)&nbsp;!=&nbsp;VK_SUCCESS)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"failed&nbsp;to&nbsp;submit&nbsp;draw&nbsp;command&nbsp;buffer&nbsp;.&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkPresentInfoKHR&nbsp;presentInfo&nbsp;=&nbsp;{};&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;presentInfo.sType&nbsp;=&nbsp;VK_STRUCTURE_TYPE_PRESENT_INFO_KHR;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;presentInfo.waitSemaphoreCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;presentInfo.pWaitSemaphores&nbsp;=&nbsp;signalSemaphores;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VkSwapchainKHR&nbsp;swapChains[]&nbsp;=&nbsp;{&nbsp;swapChain&nbsp;};&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;presentInfo.swapchainCount&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;presentInfo.pSwapchains&nbsp;=&nbsp;swapChains;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;presentInfo.pImageIndices&nbsp;=&nbsp;&amp;imageIndex;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;presentInfo.pResults&nbsp;=&nbsp;NULL;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vkQueuePresentKHR(graphicsQueue,&nbsp;&amp;presentInfo);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//clean&nbsp;up&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(auto&nbsp;framebuffer&nbsp;:&nbsp;swapChainFrameBuffer)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vkDestroyFramebuffer(logicalDevice,&nbsp;framebuffer,&nbsp;nullptr);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span><span class="comment">//&nbsp;&nbsp;vkDestroySemaphore(logicalDevice,&nbsp;renderFinishedSemaphore,&nbsp;nullptr);</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vkDestroySemaphore(logicalDevice,&nbsp;imageAvailableSemaphore,&nbsp;nullptr);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;vkDestroyCommandPool(logicalDevice,&nbsp;commandPool,&nbsp;nullptr);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;vkDestroyPipeline(logicalDevice,&nbsp;graphicsPipeline,&nbsp;nullptr);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vkDestroyPipelineLayout(logicalDevice,&nbsp;pipelineLayout,&nbsp;nullptr);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;vkDestroyRenderPass(logicalDevice,&nbsp;renderPass,&nbsp;nullptr);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(auto&nbsp;imageView&nbsp;:&nbsp;swapChainImageViews)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vkDestroyImageView(logicalDevice,&nbsp;imageView,&nbsp;nullptr);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;vkDestroySwapchainKHR(logicalDevice,&nbsp;swapChain,&nbsp;nullptr);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vkDestroyDevice(logicalDevice,&nbsp;nullptr);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;auto&nbsp;destroyFunc&nbsp;=&nbsp;(PFN_vkDestroyDebugUtilsMessengerEXT)vkGetInstanceProcAddr(instance,&nbsp;<span class="string">"vkDestroyDebugUtilsMessengerEXT"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(destroyFunc&nbsp;!=&nbsp;nullptr)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destroyFunc(instance,&nbsp;debugMessenger,&nbsp;NULL);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><span>&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;std::runtime_error(</span><span class="string">"&nbsp;not&nbsp;find&nbsp;function&nbsp;PFN_vkDestroyDebugUtilsMessengerEXT&nbsp;.&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;vkDestroySurfaceKHR(instance,&nbsp;surface,&nbsp;nullptr);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vkDestroyInstance(instance,&nbsp;nullptr);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;glfwDestroyWindow(window);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;glfwTerminate();&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;0;&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div>
			<script language="javascript">
		<!--
			dp.SyntaxHighlighter.HighlightAll('code', true,false);
			document.body.removeChild(document.getElementById("code"));
	  -->
	</script>

</body></html>